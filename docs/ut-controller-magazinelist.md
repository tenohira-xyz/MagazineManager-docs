# 雑誌一覧画面コントローラクラスの単体テスト

## 非ログイン状態で初期表示（0件）
### 条件
- 匿名ユーザ
- `/list`にGETリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|なし|0件（空のリスト）|
1. HTTPステータスがOK(200)となることを確認する。
1. `magazineList.html`をビューとして返すことを確認する。
1. 表示内容を確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|1|

## 非ログイン状態で初期表示（1件以上）
### 条件
- 匿名ユーザ
- `/list`にGETリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|なし|1件|
    - 雑誌リストの内容
    |雑誌名|号数|
    |:--|:--|
    |テスト雑誌|No.123|
1. HTTPステータスがOK(200)となることを確認する。
1. `magazineList.html`をビューとして返すことを確認する。
1. 表示内容を確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|1|

## 非ログイン状態で削除
### 条件
- 匿名ユーザ
- `/list/delete/1`にPOSTリクエストを送信する。

### 確認事項
1. HTTPステータスがForbidden(403)となることを確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|0|
|雑誌サービスクラス|削除メソッド|0|

## 管理者権限で初期表示（0件）
### 条件
- 管理者ユーザ
- `/list`にGETリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|なし|0件（空のリスト）|
1. HTTPステータスがOK(200)となることを確認する。
1. `magazineList.html`をビューとして返すことを確認する。
1. 表示内容を確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|1|

## 管理者権限で初期表示（1件以上）
### 条件
- 管理者ユーザ
- `/list`にGETリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|なし|1件|
    - 雑誌リストの内容
    |雑誌名|号数|
    |:--|:--|
    |テスト雑誌|No.123|
1. HTTPステータスがOK(200)となることを確認する。
1. `magazineList.html`をビューとして返すことを確認する。
1. 表示内容を確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|複数レコード取得メソッド|1|

## 管理者権限で削除（成功）
### 条件
- 管理者ユーザ
- `/list/delete/1`にPOSTリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|1|true|
|雑誌サービスクラス|削除メソッド|1|true|
1. HTTPステータスがOK(200)となることを確認する。
1. `magazineList.html`をビューとして返すことを確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|1|
|雑誌サービスクラス|削除メソッド|1|

## 管理者権限で削除（失敗）
### 条件
- 管理者ユーザ
- `/list/delete/1`にPOSTリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|1|true|
|雑誌サービスクラス|削除メソッド|1|false|
1. HTTPステータスがOK(200)となることを確認する。
1. `error.html`をビューとして返すことを確認する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|1|
|雑誌サービスクラス|削除メソッド|1|

## 管理者権限で削除（例外）
### 条件
- 管理者ユーザ
- `/list/delete/1`にPOSTリクエストを送信する。

### 確認事項
1. サービス層のモックを作成する。
|クラス|メソッド|引数|戻り値|
|:--|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|1|false|
1. HTTPステータスがOK(200)となることを確認する。
1. モデルに登録したパラメータにエラーメッセージが含まれているか検証する。
|名前|内容|
|:--|:--|
|status|500|
|error|エラー|
|message|指定した雑誌が存在しません。|
1. `error.html`をビューとして返すことを確認する。
1. 発生した例外が[雑誌非存在例外](exception.md#雑誌非存在例外)かを検証する。
1. サービス層のメソッドの呼び出しを検証する。
|クラス|メソッド|呼び出し回数|
|:--|:--|:--|
|雑誌サービスクラス|存在チェックメソッド（雑誌ID）|1|
|雑誌サービスクラス|削除メソッド|0|

